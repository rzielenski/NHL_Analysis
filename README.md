# NHL Analysis

This project is an attempt to push forward the accuracy of game prediction in hockey

## Current state

This project is an assortment of machine learning algorithms that have been tested in predicting the outcome of a hockey game (whether during or before the game)
Not all files are in a working state as I pushed this in a rush to get it out of google drive (yes we were using google drive for code storage lol)

If you have any questions email me at rpzielenski@gmail.com

## Future

The main focus of this repo has shifted to creating a transformer pipeline to predict the outcome of a game from an arbitrary point through next play prediction

By treating plays as tokens and training on 15 years of play by play data from [NHL API](https://github.com/Zmalski/NHL-API-Reference) we theoretically can predict the remander of the game given the context of the 2 team's stats

## Setup

Most of the files here take a path to the data specifically generated by another file (eg. NHL_Transformer has a path to play by play data generated by running Get_NHL_PBP.py)

Once that data is retrievable most files are simply plug and play (you can change the year selected to what you would like as long as you have the data for it)

## Model Descriptions

### NHL_Neural_Network

This is a simple yet effective MultiLayer Perceptron using the most influential stats from teams. The model is meant for pre-game win prediction and achieves approximately 61-62 percent accuracy (Pretty close to the highest I can find)

### NHL_CNN

The cnn is an attempt at using a sliding window across play by play data to predict the live win percentage of a given game. This needs a lot of tuning as there are many scenarios where it doesn't pass the eye test.

### NHL_LSTM

This was not my creation and is not currently in a working spot. I will be updating it when I get free time from my other projects.

Initially designed to take recent games into consideration for the nextx game to accoutn for streaky teams.

After reading more on stats and tempo in sports it seems this may not actually be a usefull feature as it seems streaks are often jus chance.

### NHL_Transfomer

This is a work in progress that I have high hopes for. The idea is to train a transformer on 15 years of play by play data in context to the team's stats before the game. This allows for prdicting most any outcome from a game (eg. Who will win, how many shots will the home team take, how many shots will player X take, etc...) and at any point (pregame or during game).

This uses plays as tokens with positional embeddings on when they happen in the game and prdicts the remaining plays in the game. 

Currenlty the next token generation works but needs improvement as I am using a baseline transformer model created from scratch (was meant to be for simple next word generation). Also, I need to find a better way to give the context of the teams playing each game for the transformer to learn from.

I am new to transformers so I'm happily taking suggestions

